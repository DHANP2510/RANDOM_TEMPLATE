import json
from shapely.geometry import Polygon
import geopandas as gpd

# Outcode centers (approximate coordinates)
outcode_centers = {
    # East London
    'E1': [-0.055, 51.515], 'E2': [-0.060, 51.530], 'E3': [0.025, 51.530],
    'E4': [0.000, 51.630], 'E5': [-0.050, 51.560], 'E6': [0.055, 51.530],
    'E7': [0.030, 51.550], 'E8': [-0.060, 51.540], 'E9': [-0.040, 51.540],
    'E10': [-0.010, 51.570], 'E11': [0.010, 51.560], 'E12': [0.050, 51.550],
    'E13': [0.010, 51.520], 'E14': [-0.020, 51.500], 'E15': [0.005, 51.540],
    'E16': [0.030, 51.510], 'E17': [-0.020, 51.580], 'E18': [0.050, 51.590],
    'E1W': [-0.070, 51.510], 'E20': [-0.020, 51.550],
    
    # Central/East Central
    'EC1A': [-0.100, 51.520], 'EC1M': [-0.100, 51.520], 'EC1N': [-0.110, 51.520],
    'EC1R': [-0.110, 51.520], 'EC1V': [-0.110, 51.530], 'EC1Y': [-0.095, 51.520],
    'EC2A': [-0.085, 51.520], 'EC2M': [-0.085, 51.515], 'EC2N': [-0.085, 51.515],
    'EC2R': [-0.085, 51.515], 'EC2V': [-0.090, 51.515], 'EC3A': [-0.080, 51.510],
    'EC3M': [-0.080, 51.510], 'EC3N': [-0.075, 51.510], 'EC3R': [-0.075, 51.510],
    'EC3V': [-0.075, 51.510], 'EC4A': [-0.105, 51.515], 'EC4M': [-0.100, 51.510],
    'EC4R': [-0.090, 51.510], 'EC4V': [-0.100, 51.510], 'EC4Y': [-0.100, 51.510],
    
    # North London
    'N1': [-0.090, 51.540], 'N2': [-0.170, 51.580], 'N3': [-0.190, 51.600],
    'N4': [-0.100, 51.570], 'N5': [-0.130, 51.550], 'N6': [-0.140, 51.570],
    'N7': [-0.130, 51.550], 'N8': [-0.120, 51.580], 'N9': [-0.060, 51.630],
    'N10': [-0.150, 51.590], 'N11': [-0.140, 51.610], 'N12': [-0.170, 51.570],
    'N13': [-0.110, 51.620], 'N14': [-0.140, 51.630], 'N15': [-0.090, 51.580],
    'N16': [-0.080, 51.570], 'N17': [-0.070, 51.600], 'N18': [-0.060, 51.610],
    'N19': [-0.130, 51.570], 'N20': [-0.170, 51.630], 'N21': [-0.120, 51.640],
    'N22': [-0.110, 51.600],
    
    # Northwest London
    'NW1': [-0.140, 51.530], 'NW2': [-0.220, 51.560], 'NW3': [-0.170, 51.550],
    'NW4': [-0.230, 51.590], 'NW5': [-0.150, 51.550], 'NW6': [-0.190, 51.540],
    'NW7': [-0.220, 51.610], 'NW8': [-0.180, 51.530], 'NW9': [-0.250, 51.590],
    'NW10': [-0.250, 51.550], 'NW11': [-0.200, 51.580],
    
    # South/Southeast London
    'SE1': [-0.090, 51.500], 'SE2': [0.100, 51.490], 'SE3': [0.020, 51.470],
    'SE4': [-0.040, 51.460], 'SE5': [-0.080, 51.480], 'SE6': [-0.050, 51.440],
    'SE7': [0.030, 51.480], 'SE8': [-0.030, 51.480], 'SE9': [0.060, 51.450],
    'SE10': [-0.010, 51.480], 'SE11': [-0.110, 51.490], 'SE12': [0.060, 51.450],
    'SE13': [-0.010, 51.460], 'SE14': [-0.040, 51.470], 'SE15': [-0.060, 51.480],
    'SE16': [-0.050, 51.500], 'SE17': [-0.090, 51.490], 'SE18': [0.070, 51.480],
    'SE19': [-0.090, 51.420], 'SE20': [-0.060, 51.410], 'SE21': [-0.090, 51.440],
    'SE22': [-0.070, 51.460], 'SE23': [-0.050, 51.440], 'SE24': [-0.090, 51.450],
    'SE25': [-0.080, 51.400], 'SE26': [-0.050, 51.430], 'SE27': [-0.100, 51.430],
    'SE28': [0.100, 51.500],
    
    # Southwest London
    'SW1A': [-0.140, 51.500], 'SW1E': [-0.140, 51.495], 'SW1H': [-0.135, 51.500],
    'SW1P': [-0.130, 51.495], 'SW1V': [-0.140, 51.490], 'SW1W': [-0.150, 51.495],
    'SW1X': [-0.150, 51.500], 'SW1Y': [-0.140, 51.505], 'SW2': [-0.120, 51.450],
    'SW3': [-0.160, 51.490], 'SW4': [-0.130, 51.460], 'SW5': [-0.190, 51.490],
    'SW6': [-0.200, 51.480], 'SW7': [-0.180, 51.500], 'SW8': [-0.120, 51.480],
    'SW9': [-0.110, 51.470], 'SW10': [-0.180, 51.480], 'SW11': [-0.170, 51.470],
    'SW12': [-0.150, 51.440], 'SW13': [-0.240, 51.470], 'SW14': [-0.260, 51.460],
    'SW15': [-0.230, 51.460], 'SW16': [-0.140, 51.420], 'SW17': [-0.160, 51.430],
    'SW18': [-0.190, 51.450], 'SW19': [-0.200, 51.420], 'SW20': [-0.230, 51.410],
    
    # West London
    'W1B': [-0.140, 51.510], 'W1C': [-0.150, 51.510], 'W1D': [-0.130, 51.510],
    'W1F': [-0.135, 51.510], 'W1G': [-0.145, 51.520], 'W1H': [-0.160, 51.520],
    'W1J': [-0.140, 51.505], 'W1K': [-0.150, 51.510], 'W1S': [-0.145, 51.510],
    'W1T': [-0.135, 51.520], 'W1U': [-0.150, 51.520], 'W1W': [-0.140, 51.520],
    'W2': [-0.180, 51.520], 'W3': [-0.270, 51.510], 'W4': [-0.270, 51.490],
    'W5': [-0.300, 51.520], 'W6': [-0.230, 51.490], 'W7': [-0.340, 51.510],
    'W8': [-0.200, 51.500], 'W9': [-0.190, 51.530], 'W10': [-0.220, 51.530],
    'W11': [-0.210, 51.510], 'W12': [-0.240, 51.510], 'W13': [-0.320, 51.520],
    'W14': [-0.210, 51.500],
    
    # West Central
    'WC1A': [-0.120, 51.520], 'WC1B': [-0.120, 51.515], 'WC1E': [-0.130, 51.520],
    'WC1H': [-0.125, 51.525], 'WC1N': [-0.120, 51.525], 'WC1R': [-0.120, 51.520],
    'WC1V': [-0.115, 51.515], 'WC1X': [-0.110, 51.525], 'WC2A': [-0.110, 51.515],
    'WC2B': [-0.120, 51.515], 'WC2E': [-0.120, 51.510], 'WC2H': [-0.130, 51.510],
    'WC2N': [-0.115, 51.510], 'WC2R': [-0.110, 51.510]
}

# Generate approximate boundaries (0.02Â° buffer around centers)
features = []
for outcode, center in outcode_centers.items():
    lon, lat = center
    features.append({
        "type": "Feature",
        "properties": {"outcode": outcode},
        "geometry": {
            "type": "Polygon",
            "coordinates": [[
                [lon-0.02, lat-0.02], [lon-0.02, lat+0.02],
                [lon+0.02, lat+0.02], [lon+0.02, lat-0.02],
                [lon-0.02, lat-0.02]  # Close polygon
            ]]
        }
    })

# Save GeoJSON
geojson = {"type": "FeatureCollection", "features": features}
with open("london_outcodes.geojson", "w") as f:
    json.dump(geojson, f, indent=2)

print("GeoJSON created: london_outcodes.geojson")

# Convert GeoJSON to Shapefile
gdf = gpd.GeoDataFrame.from_features(geojson["features"])
gdf.to_file("london_outcodes.shp")

print("Shapefile created: london_outcodes.shp")
